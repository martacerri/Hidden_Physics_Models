function [K] = ku1u0(x, xp, hyp, ubarp, dt, i)

logsigma = hyp(1);
logtheta = hyp(2);

rho = hyp(3);
alpha = hyp(4);

n_x = size(x,1);
n_xp = size(xp,1);

x = repmat(x,1,n_xp);
xp = repmat(xp',n_x,1);

ubarp = repmat(ubarp',n_x,1);

switch i


case 0

K=(1/2).*exp(1).^(logsigma+(-1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)) ...
  .*(exp(1).^((-1).*logtheta)).^(1/2).*(exp(1).^logtheta).^((-1/2).*alpha) ...
  .*pi.^(-1/2).*(2.*exp(1).^(exp(1).^((-1).*logtheta).*x.*xp).*(exp(1) ...
  .^logtheta).^((1/2).*(1+alpha)).*pi.^(1/2)+(-1).*2.^((1/2).*alpha).*(( ...
  sqrt(-1)*(-1)).^alpha+sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^(( ...
  -1).*logtheta).*(x.^2+xp.^2)).*(exp(1).^logtheta).^(1/2).*rho.*gamma(( ...
  1/2).*(1+alpha)).*Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp( ...
  1).^((-1).*logtheta).*(x+(-1).*xp).^2)+(sqrt(-1)*(-1)).*2.^((1/2).*(1+ ...
  alpha)).*((sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1).^(( ...
  1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).*gamma( ...
  1+(1/2).*alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1) ...
  .^((-1).*logtheta).*(x+(-1).*xp).^2));


case 1 % logsigma

K=(1/2).*exp(1).^(logsigma+(-1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)) ...
  .*(exp(1).^((-1).*logtheta)).^(1/2).*(exp(1).^logtheta).^((-1/2).*alpha) ...
  .*pi.^(-1/2).*(2.*exp(1).^(exp(1).^((-1).*logtheta).*x.*xp).*(exp(1) ...
  .^logtheta).^((1/2).*(1+alpha)).*pi.^(1/2)+(-1).*2.^((1/2).*alpha).*(( ...
  sqrt(-1)*(-1)).^alpha+sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^(( ...
  -1).*logtheta).*(x.^2+xp.^2)).*(exp(1).^logtheta).^(1/2).*rho.*gamma(( ...
  1/2).*(1+alpha)).*Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp( ...
  1).^((-1).*logtheta).*(x+(-1).*xp).^2)+(sqrt(-1)*(-1)).*2.^((1/2).*(1+ ...
  alpha)).*((sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1).^(( ...
  1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).*gamma( ...
  1+(1/2).*alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1) ...
  .^((-1).*logtheta).*(x+(-1).*xp).^2));


case 2 % logtheta

K=(1/12).*exp(1).^((1/2).*exp(1).^((-1).*logtheta).*(2.*exp(1).^logtheta.* ...
  logsigma+(-1).*x.^2+(-1).*xp.^2)).*(exp(1).^((-1).*logtheta)).^(1/2).*( ...
  exp(1).^logtheta).^((-1/2).*alpha).*pi.^(-1/2).*((-6).*exp(1).^(exp(1) ...
  .^((-1).*logtheta).*x.*xp).*(exp(1).^logtheta).^((1/2).*(1+alpha)).* ...
  pi.^(1/2)+6.*(1+alpha).*exp(1).^(exp(1).^((-1).*logtheta).*x.*xp).*(exp( ...
  1).^logtheta).^((1/2).*(1+alpha)).*pi.^(1/2)+(-12).*exp(1).^((-1).* ...
  logtheta+exp(1).^((-1).*logtheta).*x.*xp).*(exp(1).^logtheta).^((1/2).*( ...
  1+alpha)).*pi.^(1/2).*x.*xp+3.*2.^((1/2).*alpha).*((sqrt(-1)*(-1)) ...
  .^alpha+sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).*logtheta).* ...
  ((-2).*exp(1).^logtheta.*logtheta+x.^2+xp.^2)).*(exp(1).^logtheta).^( ...
  1/2).*rho.*(x.^2+xp.^2).*gamma((1/2).*(1+alpha)).*Hypergeometric1F1(( ...
  1/2).*(1+alpha),(1/2),(-1/2).*exp(1).^((-1).*logtheta).*(x+(-1).*xp).^2) ...
  +(sqrt(-1)*3).*2.^((1/2).*(1+alpha)).*((sqrt(-1)*(-1)).^alpha+(-1).* ...
  sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).*logtheta).*(x.^2+ ...
  xp.^2)).*rho.*(x+(-1).*xp).*gamma(1+(1/2).*alpha).*Hypergeometric1F1(( ...
  1/2).*(2+alpha),(3/2),(-1/2).*exp(1).^((-1).*logtheta).*(x+(-1).*xp).^2) ...
  +(sqrt(-1)*3).*2.^((1/2).*(1+alpha)).*((sqrt(-1)*(-1)).^alpha+(-1).* ...
  sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).*logtheta).*((-2).* ...
  exp(1).^logtheta.*logtheta+x.^2+xp.^2)).*rho.*(x+(-1).*xp).*(x.^2+xp.^2) ...
  .*gamma(1+(1/2).*alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2) ...
  .*exp(1).^((-1).*logtheta).*(x+(-1).*xp).^2)+(-3).*alpha.*(2.*exp(1).^( ...
  exp(1).^((-1).*logtheta).*x.*xp).*(exp(1).^logtheta).^((1/2).*(1+alpha)) ...
  .*pi.^(1/2)+(-1).*2.^((1/2).*alpha).*((sqrt(-1)*(-1)).^alpha+sqrt(-1) ...
  .^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)).*( ...
  exp(1).^logtheta).^(1/2).*rho.*gamma((1/2).*(1+alpha)).* ...
  Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2)+(sqrt(-1)*(-1)).*2.^((1/2).*(1+alpha)).*(( ...
  sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1) ...
  .^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).*gamma(1+(1/2).* ...
  alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2))+3.*exp(1).^((-1).*logtheta).*(x.^2+xp.^2).* ...
  (2.*exp(1).^(exp(1).^((-1).*logtheta).*x.*xp).*(exp(1).^logtheta).^(( ...
  1/2).*(1+alpha)).*pi.^(1/2)+(-1).*2.^((1/2).*alpha).*((sqrt(-1)*(-1)) ...
  .^alpha+sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).*logtheta).* ...
  (x.^2+xp.^2)).*(exp(1).^logtheta).^(1/2).*rho.*gamma((1/2).*(1+alpha)).* ...
  Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2)+(sqrt(-1)*(-1)).*2.^((1/2).*(1+alpha)).*(( ...
  sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1) ...
  .^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).*gamma(1+(1/2).* ...
  alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2))+(-3).*2.^((1/2).*alpha).*((sqrt(-1)*(-1)) ...
  .^alpha+sqrt(-1).^alpha).*(1+alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).* ...
  logtheta).*((-2).*exp(1).^logtheta.*logtheta+x.^2+xp.^2)).*(exp(1) ...
  .^logtheta).^(1/2).*rho.*(x+(-1).*xp).^2.*gamma((1/2).*(1+alpha)).* ...
  Hypergeometric1F1((1/2).*(3+alpha),(3/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2)+(sqrt(-1)*(-1)).*2.^((1/2).*(1+alpha)).*(( ...
  sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*(2+alpha).*dt.*exp(1).^(( ...
  1/2).*exp(1).^((-1).*logtheta).*((-2).*exp(1).^logtheta.*logtheta+x.^2+ ...
  xp.^2)).*rho.*(x+(-1).*xp).^3.*gamma(1+(1/2).*alpha).*Hypergeometric1F1( ...
  (1/2).*(4+alpha),(5/2),(-1/2).*exp(1).^((-1).*logtheta).*(x+(-1).*xp) ...
  .^2));


case 3 % rho

K=(-1).*2.^((-1)+(1/2).*alpha).*dt.*exp(1).^logsigma.*(exp(1).^((-1).* ...
  logtheta)).^(1/2).*(exp(1).^logtheta).^((-1/2).*alpha).*pi.^(-1/2).*((( ...
  sqrt(-1)*(-1)).^alpha+sqrt(-1).^alpha).*(exp(1).^logtheta).^(1/2).* ...
  gamma((1/2).*(1+alpha)).*Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2) ...
  .*exp(1).^((-1).*logtheta).*(x+(-1).*xp).^2)+sqrt(-1).*2.^(1/2).*((sqrt( ...
  -1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*(x+(-1).*xp).*gamma(1+(1/2).* ...
  alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2));


case 4 % alpha

K=(-1/4).*exp(1).^(logsigma+(-1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2) ...
  ).*(exp(1).^((-1).*logtheta)).^(1/2).*(exp(1).^logtheta).^((-1/2).* ...
  alpha).*pi.^(-1/2).*(2.*exp(1).^(exp(1).^((-1).*logtheta).*x.*xp).*(exp( ...
  1).^logtheta).^((1/2).*(1+alpha)).*pi.^(1/2)+(-1).*2.^((1/2).*alpha).*(( ...
  sqrt(-1)*(-1)).^alpha+sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^(( ...
  -1).*logtheta).*(x.^2+xp.^2)).*(exp(1).^logtheta).^(1/2).*rho.*gamma(( ...
  1/2).*(1+alpha)).*Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp( ...
  1).^((-1).*logtheta).*(x+(-1).*xp).^2)+(sqrt(-1)*(-1)).*2.^((1/2).*(1+ ...
  alpha)).*((sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1).^(( ...
  1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).*gamma( ...
  1+(1/2).*alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1) ...
  .^((-1).*logtheta).*(x+(-1).*xp).^2)).*log(exp(1).^logtheta)+(1/2).*exp( ...
  1).^(logsigma+(-1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)).*(exp(1) ...
  .^((-1).*logtheta)).^(1/2).*(exp(1).^logtheta).^((-1/2).*alpha).*pi.^( ...
  -1/2).*(sqrt(-1).*2.^((-1)+(1/2).*alpha).*((sqrt(-1)*(-1)).^alpha+(-1).* ...
  sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).*logtheta).*(x.^2+ ...
  xp.^2)).*(exp(1).^logtheta).^(1/2).*pi.*rho.*gamma((1/2).*(1+alpha)).* ...
  Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2)+(-1).*2.^((1/2).*((-1)+alpha)).*((sqrt(-1)*( ...
  -1)).^alpha+sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).* ...
  logtheta).*(x.^2+xp.^2)).*pi.*rho.*(x+(-1).*xp).*gamma(1+(1/2).*alpha).* ...
  Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2)+(-1).*2.^((-1)+(1/2).*alpha).*((sqrt(-1)*( ...
  -1)).^alpha+sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).* ...
  logtheta).*(x.^2+xp.^2)).*(exp(1).^logtheta).^(1/2).*rho.*gamma((1/2).*( ...
  1+alpha)).*Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp(1).^(( ...
  -1).*logtheta).*(x+(-1).*xp).^2).*log(2)+(sqrt(-1)*(-1)).*2.^((1/2).*(( ...
  -1)+alpha)).*((sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1) ...
  .^((1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).* ...
  gamma(1+(1/2).*alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).* ...
  exp(1).^((-1).*logtheta).*(x+(-1).*xp).^2).*log(2)+exp(1).^(exp(1).^(( ...
  -1).*logtheta).*x.*xp).*(exp(1).^logtheta).^((1/2).*(1+alpha)).*pi.^( ...
  1/2).*log(exp(1).^logtheta)+(sqrt(-1)*(-1)).*2.^((1/2).*((-1)+alpha)).*( ...
  (sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp( ...
  1).^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).*gamma(1+(1/2).* ...
  alpha).*Hypergeometric1F1((1/2).*(2+alpha),(3/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2).*psi(0,1+(1/2).*alpha)+(-1).*2.^((-1)+ ...
  (1/2).*alpha).*((sqrt(-1)*(-1)).^alpha+sqrt(-1).^alpha).*dt.*exp(1).^(( ...
  1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)).*(exp(1).^logtheta).^(1/2) ...
  .*rho.*gamma((1/2).*(1+alpha)).*Hypergeometric1F1((1/2).*(1+alpha),(1/2) ...
  ,(-1/2).*exp(1).^((-1).*logtheta).*(x+(-1).*xp).^2).*psi(0,(1/2).* ...
  (1+alpha))+(-1).*2.^((-1)+(1/2).*alpha).*((sqrt(-1)*(-1)).^alpha+sqrt( ...
  -1).^alpha).*dt.*exp(1).^((1/2).*exp(1).^((-1).*logtheta).*(x.^2+xp.^2)) ...
  .*(exp(1).^logtheta).^(1/2).*rho.*gamma((1/2).*(1+alpha)).*...
  Derivative100Hypergeometric1F1((1/2).*(1+alpha),(1/2),(-1/2).*exp(1).^((-1).* ...
  logtheta).*(x+(-1).*xp).^2)+(sqrt(-1)*(-1)).*2.^((1/2).*((-1)+alpha)).*( ...
  (sqrt(-1)*(-1)).^alpha+(-1).*sqrt(-1).^alpha).*dt.*exp(1).^((1/2).*exp( ...
  1).^((-1).*logtheta).*(x.^2+xp.^2)).*rho.*(x+(-1).*xp).*gamma(1+(1/2).* ...
  alpha).*Derivative100Hypergeometric1F1((1/2).*(2+alpha),(3/2),( ...
  -1/2).*exp(1).^((-1).*logtheta).*(x+(-1).*xp).^2));


otherwise
        
        K = zeros(n_x, n_xp);
end

if K == 0

    K = zeros(n_x, n_xp);

end

end
